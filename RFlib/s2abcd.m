
function M = s2abcd(S, Z0)
    S12S21 = S(1,2) * S(2,1)
    M = zeros(2)
    M(1,1) = (((1 + S(1,1)) * (1 - S(2,2))) + S12S21) / (2 * S(2,1))
    M(1,2) = ((((1 + S(1,1)) * (1 + S(2,2))) - S12S21) / (2 * S(2,1))) * Z0
    M(2,1) = ((((1 - S(1,1)) * (1 - S(2,2))) - S12S21) / (2 * S(2,1))) * Admittance(Z0)
    M(2,2) = (((1 - S(1,1)) * (1 + S(2,2))) + S12S21) / (2 * S(2,1))
end

