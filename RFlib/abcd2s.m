
function S = abcd2s(M, Z0)
    denom = (M(1,1) + (M(1,2) / Z0) + (M(2,1) * Z0) + M(2,2));
    S = zeros(2);
    S(1,1) = (M(1,1) + (M(1,2) / Z0) - (M(2,1) * Z0) - M(2,2)) / denom;
    S(1,2) = (2 * ((M(1,1) * M(2,2)) - (M(1,2) * M(2,1)))) / denom;
    S(2,1) = 2 / denom;
    S(2,2) = ((-1 * M(1,1)) + (M(1,2) / Z0) - (M(2,1) * Z0) + M(2,2)) / denom;
end
 
